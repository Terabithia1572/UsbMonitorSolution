<Window x:Class="UsbMonitorAgent.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="USB Kopyalama Logları"
        Height="500"
        Width="1100"
        WindowStartupLocation="CenterScreen">

    <!-- SAĞ TIK MENÜ -->
    <Window.ContextMenu>
        <ContextMenu>
            <MenuItem Header="Takılı USB Aygıtları" Click="OpenUsbList_Click"/>
        </ContextMenu>
    </Window.ContextMenu>

    <Grid>

        <!-- 2 Satır: Üst menü + DataGrid -->
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- ÜST MENÜ (CSV + Excel) -->
        <StackPanel Orientation="Horizontal"
                    Margin="10"
                    HorizontalAlignment="Right"
                    Grid.Row="0">
            <Button Content="CSV Olarak Dışa Aktar" 
                    Width="160" Height="30"
                    Margin="0,0,10,0"
                    Click="ExportCsv_Click"/>

            <Button Content="Excel Olarak Dışa Aktar"
                    Width="160" Height="30"
                    Click="ExportExcel_Click"/>
            
        </StackPanel>

        <!-- LOG TABLE -->
        <DataGrid x:Name="LogsGrid"
                  Grid.Row="1"
                  AutoGenerateColumns="False"
                  IsReadOnly="True"
                  Margin="10"
                  FontSize="14"
                  HeadersVisibility="Column">

            <DataGrid.Columns>

                <DataGridTextColumn Header="Kullanıcı" Binding="{Binding Username}" Width="120"/>
                <DataGridTextColumn Header="Dosya Adı" Binding="{Binding FileName}" Width="200"/>
                <DataGridTextColumn Header="Kaynak Yol" Binding="{Binding SourcePath}" Width="200"/>
                <DataGridTextColumn Header="Hedef Yol" Binding="{Binding DestPath}" Width="260"/>
                <DataGridTextColumn Header="USB Etiketi" Binding="{Binding DriveLabel}" Width="120"/>
                <DataGridTextColumn Header="VID / PID / SN" Binding="{Binding DeviceIdentity}" Width="170"/>
                <DataGridTextColumn Header="Boyut" Binding="{Binding FileSizeFormatted}" Width="80"/>
                <DataGridTextColumn Header="Tarih" Binding="{Binding TimestampUtc}" Width="150"/>

                <!-- 🔥 HASH ALANINDA KOPYALANABİLİR TEXTBOX -->
                <DataGridTemplateColumn Header="SHA256 Hash" Width="420">
                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <TextBox Text="{Binding FileHash}"
                                     BorderThickness="0"
                                     Background="Transparent"
                                     IsReadOnly="True"
                                     FontSize="13"
                                     Padding="2"
                                     VerticalAlignment="Center"
                                     Foreground="Black"
                                     IsReadOnlyCaretVisible="True"/>
                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                </DataGridTemplateColumn>

            </DataGrid.Columns>

        </DataGrid>

    </Grid>

</Window>
